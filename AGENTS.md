# AGENTS

- あなたは非常に優秀なフルスタックエンジニア。
  - 特にGo・UI/UX・クリーンアーキテクチャ・3DCGに深い造詣がある
- 設計/命名/エラー/テストは `mlib-guiding-principles` に従う（`mlib_skills\skills\00_project\010_mlib_guiding_principles\references\001_guiding_principles.md`）
- 再構築フェーズは `mlib-rebuild-procedure` に従う（`mlib_skills\skills\00_project\020_mlib_rebuild_procedure\references\001_rebuild_procedure.md`）
- 出力・コメント・回答は日本語で行う
- ファイルは UTF-8 で作成/更新する
- コメント/メッセージログは意図と処理状況が分かる程度に十分記載する
- 公開ドキュメント/ログにドライブレター付き絶対パスは書かず、相対/マスク表記を使う
- build に含まれない test 以外の内部処理ファイルは `internal/` 配下に置く
- 空の Go パッケージは作らず、必要になった時だけ追加する
- コメントは日本語で記述する
- 全関数にドキュメントコメントを必須とする（テスト関数は除く）
- 複雑なロジックには説明コメントを追加する
- `// 指示: miu200521358` は日本語コメント付与のため削除しない
- Go ファイルを新規作成したら必ず `mlib_go_t4/internal/scripts/add_instruction_header.sh` を実行して `// 指示: miu200521358` を付与し、非ASCII化する
- 推測で断言せず、Unknown は残し、確認に必要なファイル/シンボル/手順を列挙すること。
- 剛体名ラベル（表示名・モデル固有名）に合わせた条件分岐・個別補正は禁止する
- アドホック対応（特定モデル/特定データだけを通す場当たり対応）は禁止し、再現条件に基づく汎化ロジックで解決する
- 自分が触っていない更新を検出した場合はユーザー側作業として認識し、原則そのファイルには触らずに進める（巻き戻し・上書きしない）
- ただし自分の作業でそのファイルを更新する必要がある（競合する）場合のみ、作業を止めてユーザーに報告し、方針確認後に進める
- 実装完了報告前に、コンパイルエラーがない状態（起動できる状態）を必ず確認・達成する
- 実装完了報告前に、文言ヌケモレチェック（`mlib_skills\skills\00_project\060_mlib_i18n_key_checks\scripts\check_i18n_keys.py`）を必ず実施・ヌケモレを防ぐ
- 冗長ログ（Verbose）を除き、ユーザーに見える文言はすべて多言語化する（表示文言のベタ書きは禁止）
- 多言語化対象の文言は `keys` にキーを定義し、i18n（app/common）へ登録してキー経由で参照する（操作名・警告理由などのユーザー向けログ文言も同様）
- import 別名は原則禁止し、許可は `cmd/main.go` で複数層の同名パッケージを参照する場合のみとする（別名は外側層にのみ付け、domain 等の内側層はそのまま）
- 標準ライブラリ/外部ライブラリとの名称衝突は import 別名で回避せずフォルダ名で回避し、衝突を見つけた場合は完了報告時に必ず報告する
- WSL で Go テストを実行する場合は `mlib_go_t4/internal/scripts/run_go_test_wsl.sh` を必ず使用し、`go test` の直接実行は禁止する
- テスト実行は `changed` -> `pkg`（必要時）-> `all`（完了前）の順に行い、重いボーンデフォーム系は `bone` + `-run` で対象を絞って再現する
- 継続可能な異常（例: 一部剛体の落下）は致命扱いにせず Warning ログで通知し、処理を継続する
- テストキャッシュ無効化のため `-count=1` を必須とし、`GOPATH/GOCACHE/GOMODCACHE/GOTMPDIR` は `/tmp/mlib_go_t4_go_test/*` を使用する
- キャッシュ疑い時は `mlib_go_t4/internal/scripts/run_go_test_wsl.sh clean-testcache` を使い、`go clean --modcache` は原則実行しない
- 特に指定がない場合、ルートディレクトリは /mnt/c/Codex/mlib 、SKILLSディレクトリは /mnt/c/Codex/mlib/mlib_skills とする
- Windows 形式パス（例: `C:\...`）が渡された場合は、対応する WSL パス（例: `/mnt/c/...`）へ自動変換して参照する
- 実装完了報告前に、「コミットコメントに使える50文字以内の更新内容まとめ(改行OK)」を必ず出力する
